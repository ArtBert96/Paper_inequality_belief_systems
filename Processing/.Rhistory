select(variable, dif_mean, pvalues)
#loop each V and run t.test
tests_list <- lapply(seq_along(mijs_us2), function(i){
t.test(mijs_us2[[i]], mijs_us3[[i]])
})
means = sapply(tests_list, '[[', 'estimate')
dif_mean = means[1,] - means[2,]
pvalues = as.data.frame(sapply(tests_list, '[[', 'p.value'))
#print true when the means differ
pvalues = pvalues %>%
rename(pvalues = "sapply(tests_list, \"[[\", \"p.value\")") %>%
bind_cols(names(mijs_us2))
mult_test = 0.05/nrow(pvalues)
pvalues_us23 = pvalues %>%
rename(variable = "...2")  %>%
bind_cols(dif_mean) %>%
filter(pvalues<mult_test) %>%
rename(dif_mean = "...3") %>%
select(variable, dif_mean, pvalues)
#loop each V and run t.test
tests_list <- lapply(seq_along(mijs_us1), function(i){
t.test(mijs_us1[[i]], mijs_us3[[i]])
})
means = sapply(tests_list, '[[', 'estimate')
dif_mean = means[1,] - means[2,]
pvalues = as.data.frame(sapply(tests_list, '[[', 'p.value'))
#print true when the means differ
pvalues = pvalues %>%
rename(pvalues = "sapply(tests_list, \"[[\", \"p.value\")") %>%
bind_cols(names(mijs_us1))
mult_test = 0.05/nrow(pvalues)
pvalues_us13 = pvalues %>%
rename(variable = "...2")  %>%
bind_cols(dif_mean) %>%
filter(pvalues<mult_test) %>%
rename(dif_mean = "...3") %>%
select(variable, dif_mean, pvalues)
pvalues_us01
pvalues_us02
pvalues_us03
pvalues_us12
pvalues_us13
pvalues_us23
#loop each V and run t.test
tests_list <- lapply(seq_along(mijs_nl0), function(i){
t.test(mijs_nl0[[i]], mijs_nl1[[i]])
})
means = sapply(tests_list, '[[', 'estimate')
dif_mean = means[1,] - means[2,]
pvalues = as.data.frame(sapply(tests_list, '[[', 'p.value'))
#print true when the means differ
pvalues = pvalues %>%
rename(pvalues = "sapply(tests_list, \"[[\", \"p.value\")") %>%
bind_cols(names(mijs_nl0))
mult_test = 0.05/nrow(pvalues)
pvalues_nl01 = pvalues %>%
rename(variable = "...2")  %>%
bind_cols(dif_mean) %>%
filter(pvalues<mult_test) %>%
rename(dif_mean = "...3") %>%
select(variable, dif_mean, pvalues)
#loop each V and run t.test
tests_list <- lapply(seq_along(mijs_nl0), function(i){
t.test(mijs_nl0[[i]], mijs_nl2[[i]])
})
means = sapply(tests_list, '[[', 'estimate')
dif_mean = means[1,] - means[2,]
pvalues = as.data.frame(sapply(tests_list, '[[', 'p.value'))
#print true when the means differ
pvalues = pvalues %>%
rename(pvalues = "sapply(tests_list, \"[[\", \"p.value\")") %>%
bind_cols(names(mijs_nl0))
mult_test = 0.05/nrow(pvalues)
pvalues_nl02 = pvalues %>%
rename(variable = "...2")  %>%
bind_cols(dif_mean) %>%
filter(pvalues<mult_test) %>%
rename(dif_mean = "...3") %>%
select(variable, dif_mean, pvalues)
#loop each V and run t.test
tests_list <- lapply(seq_along(mijs_nl1), function(i){
t.test(mijs_nl1[[i]], mijs_nl2[[i]])
})
means = sapply(tests_list, '[[', 'estimate')
dif_mean = means[1,] - means[2,]
pvalues = as.data.frame(sapply(tests_list, '[[', 'p.value'))
#print true when the means differ
pvalues = pvalues %>%
rename(pvalues = "sapply(tests_list, \"[[\", \"p.value\")") %>%
bind_cols(names(mijs_nl1))
mult_test = 0.05/nrow(pvalues)
pvalues_nl12 = pvalues %>%
rename(variable = "...2")  %>%
bind_cols(dif_mean) %>%
filter(pvalues<mult_test) %>%
rename(dif_mean = "...3") %>%
select(variable, dif_mean, pvalues)
pvalues_nl01
pvalues_nl02
pvalues_nl12
#US
mijs_us_skim  = mijs_us %>%
mutate_if(is.character, as.numeric) %>%
mutate_if(is.factor, as.numeric) %>%
as.data.frame() %>%
stargazer(type = "text")
#NL
mijs_nl_skim  = mijs_nl %>%
mutate_if(is.character, as.numeric) %>%
mutate_if(is.factor, as.numeric) %>%
as.data.frame() %>%
stargazer(type = "text")
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
p_load(tidyverse, janitor, here, haven, labelled, sjmisc, skimr, ggplot2, jtools,
stargazer, IsingFit, qgraph, Matrix, igraph, NetworkComparisonTest, bootnet,
rio, IsingSampler, compute.es, foreign, mgm, matrixcalc, openxlsx, RColorBrewer,
corclass, poLCA, conflicted, EGAnet)
#Packages conflicts
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
options(max.print=999999)
options(scipen=999)
#data US
load(here("Output",  "230313 - Mijs_US_Databases.RData"))
US=mijs_us_ib
#data NL
load(here("Output",  "230313 - Mijs_NL_Databases.RData"))
NL=mijs_nl_ib
#CCA applied to ISSP US
CCA_group <- cca(US, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
plot(CCA_group, 1)
plot(CCA_group, 2)
#preliminary plots
plot(CCA_group, 1)
# plot(CCA_group, 2)
plot(CCA_group, 3)
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
p_load(tidyverse, janitor, here, haven, labelled, sjmisc, skimr, ggplot2, jtools,
stargazer, IsingFit, qgraph, Matrix, igraph, NetworkComparisonTest, bootnet,
rio, IsingSampler, compute.es, foreign, mgm, matrixcalc, openxlsx, RColorBrewer,
corclass, poLCA, conflicted, EGAnet)
#Packages conflicts
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
options(max.print=999999)
options(scipen=999)
#data US
load(here("Output",  "230313 - Mijs_US_Databases.RData"))
US=mijs_us_ib
#data NL
load(here("Output",  "230313 - Mijs_NL_Databases.RData"))
NL=mijs_nl_ib
#CCA applied to ISSP US
CCA_group <- cca(US, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
#preliminary plots
plot(CCA_group, 1)
# plot(CCA_group, 2)
plot(CCA_group, 3)
#their cor matrix
#print(round(CCA_group$modules[[1]]$cormat,1))
#print(round(CCA_group$modules[[1]]$cormat,2))
#print(round(CCA_group$modules[[1]]$cormat,3))
#add membership to US
US_CCA = US
US_CCA$mem = CCA_group$membership
#prepare CCA-driven dataframe for EGA
CCA_US_1 = US_CCA %>%
as.data.frame() %>%
filter(mem == 1) %>%
select(perc_income:ib_sex)
CCA_US_2 = US_CCA %>%
as.data.frame() %>%
filter(mem == 3) %>%
select(perc_income:ib_sex)
f1 <- as.formula(cbind(perc_income,perc_wealth,perc_poor,perc_black,
bel_merit,bel_diversity,bel_equality,ib_weafam,ib_edupar,
ib_edu,ib_work,ib_people,ib_race,ib_migra,ib_relig,ib_sex)~1)
#lcas
LCA_US_2 <- poLCA(f1, data=US, nclass=2, maxiter=3000, nrep=5)
LCA_US_3 <- poLCA(f1, data=US, nclass=3, maxiter=3000, nrep=5)
LCA_US_4 <- poLCA(f1, data=US, nclass=4, maxiter=3000, nrep=5)
LCA_US_5 <- poLCA(f1, data=US, nclass=5, maxiter=3000, nrep=5)
LCA_US_6 <- poLCA(f1, data=US, nclass=6, maxiter=3000, nrep=5)
LCA_US_7 <- poLCA(f1, data=US, nclass=7, maxiter=3000, nrep=5) #the chosen one
LCA_US_8 <- poLCA(f1, data=US, nclass=8, maxiter=3000, nrep=5)
LCA_US_2_a <- poLCA(f1, data=US, nclass=2)
LCA_US_3_a <- poLCA(f1, data=US, nclass=3)
LCA_US_4_a <- poLCA(f1, data=US, nclass=4)
LCA_US_5_a <- poLCA(f1, data=US, nclass=5)
LCA_US_6_a <- poLCA(f1, data=US, nclass=6) #the chosen one, without iteration
LCA_US_7_a <- poLCA(f1, data=US, nclass=7)
LCA_US_8_a <- poLCA(f1, data=US, nclass=8)
plot(LCA7)
#plot
plot(LCA_US_7)
pdf(file = '../Output/7.pdf',
height = 9, width = 12)
plot(LCA_US_7)
dev.off()
LCA_US_2 <- poLCA(f1, data=US, nclass=2, maxiter=3000, nrep=5)
LCA_US_3 <- poLCA(f1, data=US, nclass=3, maxiter=3000, nrep=5)
LCA_US_4 <- poLCA(f1, data=US, nclass=4, maxiter=3000, nrep=5)
LCA_US_5 <- poLCA(f1, data=US, nclass=5, maxiter=3000, nrep=5)
LCA_US_6 <- poLCA(f1, data=US, nclass=6, maxiter=3000, nrep=5)
set.seed(123)
LCA_US_7 <- poLCA(f1, data=US, nclass=7, maxiter=3000, nrep=5) #the chosen one
LCA_US_8 <- poLCA(f1, data=US, nclass=8, maxiter=3000, nrep=5)
LCA_US_2_a <- poLCA(f1, data=US, nclass=2)
LCA_US_3_a <- poLCA(f1, data=US, nclass=3)
LCA_US_4_a <- poLCA(f1, data=US, nclass=4)
LCA_US_5_a <- poLCA(f1, data=US, nclass=5)
LCA_US_6_a <- poLCA(f1, data=US, nclass=6)
set.seed(123)
LCA_US_7_a <- poLCA(f1, data=US, nclass=7) #the chosen one, without iteration
LCA_US_8_a <- poLCA(f1, data=US, nclass=8)
pdf(file = '../Output/7.pdf',
height = 9, width = 12)
plot(LCA_US_7)
dev.off()
pdf(file = '../Output/7a.pdf',
height = 9, width = 12)
plot(LCA_US_7_a)
dev.off()
##plot
pdf(file = '../Output/7.pdf',
height = 9, width = 12)
plot(LCA_US_7)
dev.off()
#add predclass to US and merge
US_CCA$pred = LCA6$predclass
US_CCA$pred = LCA_US_6$predclass
#filter out second CCA class
US_CCA = US_CCA %>%
filter(mem != 2)
#filter useless v
US_CCA1_EGA = US_CCA %>%
filter(mem == 1) %>%
select(ineq_post1:ib_sex)
#filter useless v
US_CCA1_EGA = US_CCA %>%
filter(mem == 1) %>%
select(perc_income:ib_sex)
US_CCA2_EGA = US_CCA %>%
filter(mem == 3) %>%
select(perc_income:ib_sex)
ega_CCA1 <- EGA(data=US_CCA1_EGA,  model = "glasso",
plot.EGA = TRUE)
ega_CCA2 <- EGA(data=US_CCA2_EGA,  model = "glasso",
plot.EGA = TRUE)
?EGA
ega_CCA1 <- EGA(data=US_CCA1_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_CCA2 <- EGA(data=US_CCA2_EGA,  model = "TMFG",
plot.EGA = TRUE)
?EGA.estimate
ega_CCA1 <- EGA(data=US_CCA1_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_CCA2 <- EGA(data=US_CCA2_EGA,  model = "TMFG",
plot.EGA = TRUE)
US_CCA$pred = LCA_US_7$predclass
US_CCA = US_CCA %>%
filter(mem != 2)
#add predclass to US and merge
US_CCA$pred = LCA_US_7$predclass
US_CCA
LCA_US_7
LCA_US_7$predclass
US_CCA = US_CCA %>%
filter(mem != 2)
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
p_load(tidyverse, janitor, here, haven, labelled, sjmisc, skimr, ggplot2, jtools,
stargazer, IsingFit, qgraph, Matrix, igraph, NetworkComparisonTest, bootnet,
rio, IsingSampler, compute.es, foreign, mgm, matrixcalc, openxlsx, RColorBrewer,
corclass, poLCA, conflicted, EGAnet)
#Packages conflicts
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
options(max.print=999999)
options(scipen=999)
#data US
load(here("Output",  "230313 - Mijs_US_Databases.RData"))
US=mijs_us_ib
#data NL
load(here("Output",  "230313 - Mijs_NL_Databases.RData"))
NL=mijs_nl_ib
#CCA applied to ISSP US
CCA_group <- cca(US, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
#preliminary plots
plot(CCA_group, 1)
# plot(CCA_group, 2)
plot(CCA_group, 3)
#their cor matrix
#print(round(CCA_group$modules[[1]]$cormat,1))
#print(round(CCA_group$modules[[1]]$cormat,2))
#print(round(CCA_group$modules[[1]]$cormat,3))
#add membership to US
US_CCA = US
US_CCA$mem = CCA_group$membership
#prepare CCA-driven dataframe for EGA
CCA_US_1 = US_CCA %>%
as.data.frame() %>%
filter(mem == 1) %>%
select(perc_income:ib_sex)
CCA_US_2 = US_CCA %>%
as.data.frame() %>%
filter(mem == 3) %>%
select(perc_income:ib_sex)
f1 <- as.formula(cbind(perc_income,perc_wealth,perc_poor,perc_black,
bel_merit,bel_diversity,bel_equality,ib_weafam,ib_edupar,
ib_edu,ib_work,ib_people,ib_race,ib_migra,ib_relig,ib_sex)~1)
#lcas
LCA_US_2 <- poLCA(f1, data=US, nclass=2, maxiter=3000, nrep=5)
LCA_US_3 <- poLCA(f1, data=US, nclass=3, maxiter=3000, nrep=5)
LCA_US_4 <- poLCA(f1, data=US, nclass=4, maxiter=3000, nrep=5)
LCA_US_5 <- poLCA(f1, data=US, nclass=5, maxiter=3000, nrep=5)
LCA_US_6 <- poLCA(f1, data=US, nclass=6, maxiter=3000, nrep=5)
set.seed(123)
LCA_US_7 <- poLCA(f1, data=US, nclass=7, maxiter=3000, nrep=5) #the chosen one
LCA_US_8 <- poLCA(f1, data=US, nclass=8, maxiter=3000, nrep=5)
##plot
pdf(file = '../Output/7.pdf',
height = 9, width = 12)
plot(LCA_US_7)
dev.off()
#comment for LCA6
#1: low perception mid-high individualist and low structuralist
#2: mid high perception high individualist low structuralist
#3: high perception mid high individualist mid low structuralist
#4: mid high perception mid-high individualist and mid low structuralist
#5: super high perception, mid high individualist and mid structuralist
#6: mid high everything
#7: super high evrything
US_CCA
LCA_US_7$predclass
US_CCA$pred = LCA_US_7$predclass
US_CCA = US_CCA %>%
filter(mem != 2)
#filter useless v
US_CCA1_EGA = US_CCA %>%
filter(mem == 1) %>%
select(perc_income:ib_sex)
US_CCA2_EGA = US_CCA %>%
filter(mem == 3) %>%
select(perc_income:ib_sex)
ega_CCA1 <- EGA(data=US_CCA1_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_CCA2 <- EGA(data=US_CCA2_EGA,  model = "TMFG",
plot.EGA = TRUE)
US_LCA1_EGA = US_CCA %>%
filter(pred == 1) %>%
select(perc_income:ib_sex)
US_LCA2_EGA = US_CCA %>%
filter(pred == 2) %>%
select(perc_income:ib_sex)
US_LCA3_EGA = US_CCA %>%
filter(pred == 3) %>%
select(perc_income:ib_sex)
US_LCA4_EGA = US_CCA %>%
filter(pred == 4) %>%
select(perc_income:ib_sex)
US_LCA5_EGA = US_CCA %>%
filter(pred == 5) %>%
select(perc_income:ib_sex)
US_LCA6_EGA = US_CCA %>%
filter(pred == 6) %>%
select(perc_income:ib_sex)
US_LCA7_EGA = US_CCA %>%
filter(pred == 7) %>%
select(perc_income:ib_sex)
ega_LCA_US_1 <- EGA(data=US_LCA1_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_2 <- EGA(data=US_LCA2_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_3 <- EGA(data=US_LCA3_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_4 <- EGA(data=US_LCA4_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_5 <- EGA(data=US_LCA5_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_6 <- EGA(data=US_LCA6_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_7 <- EGA(data=US_LCA7_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_1 <- EGA(data=US_LCA1_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_2 <- EGA(data=US_LCA2_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_3 <- EGA(data=US_LCA3_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_4 <- EGA(data=US_LCA4_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_5 <- EGA(data=US_LCA5_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_6 <- EGA(data=US_LCA6_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_7 <- EGA(data=US_LCA7_EGA,  model = "TMFG",
plot.EGA = TRUE)
US_LCA7_EGA
US_LCA5_EGA
US_LCA7_EGA
stargazer(US_LCA7_EGA, type = "text")
skim(US_LCA7_EGA)
skim(US_LCA7_EGA)
ega_LCA_US_7 <- EGA(data=US_LCA7_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_1 <- EGA(data=US_LCA1_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_2 <- EGA(data=US_LCA2_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_3 <- EGA(data=US_LCA3_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_4 <- EGA(data=US_LCA4_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_5 <- EGA(data=US_LCA5_EGA,  model = "TMFG", # da problemi
plot.EGA = TRUE)
ega_LCA_US_6 <- EGA(data=US_LCA6_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_US_1 <- EGA(data=US_LCA1_EGA,  model = "glassso",
plot.EGA = TRUE)
ega_LCA_US_1 <- EGA(data=US_LCA1_EGA,  model = "glasso",
plot.EGA = TRUE)
#CCA applied to ISSP NL
CCA_group <- cca(NL, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
#preliminary plots
plot(CCA_group, 1)
# plot(CCA_group, 2)
plot(CCA_group, 3)
#their cor matrix
#print(round(CCA_group$modules[[1]]$cormat,1))
#print(round(CCA_group$modules[[1]]$cormat,2))
#print(round(CCA_group$modules[[1]]$cormat,3))
#add membership to NL
NL_CCA = NL
NL_CCA$mem = CCA_group$membership
#prepare CCA-driven dataframe for EGA
CCA_NL_1 = NL_CCA %>%
as.data.frame() %>%
filter(mem == 1) %>%
select(perc_income:ib_sex)
CCA_NL_2 = NL_CCA %>%
as.data.frame() %>%
filter(mem == 3) %>%
select(perc_income:ib_sex)
f1 <- as.formula(cbind(perc_income,perc_wealth,perc_poor,perc_black,
bel_merit,bel_diversity,bel_equality,ib_weafam,ib_edupar,
ib_edu,ib_work,ib_people,ib_race,ib_migra,ib_relig,ib_sex)~1)
LCA_NL_2 <- poLCA(f1, data=NL, nclass=2, maxiter=3000, nrep=5)
LCA_NL_3 <- poLCA(f1, data=NL, nclass=3, maxiter=3000, nrep=5)
LCA_NL_4 <- poLCA(f1, data=NL, nclass=4, maxiter=3000, nrep=5)
LCA_NL_5 <- poLCA(f1, data=NL, nclass=5, maxiter=3000, nrep=5)
LCA_NL_6 <- poLCA(f1, data=NL, nclass=6, maxiter=3000, nrep=5)
set.seed(123)
LCA_NL_7 <- poLCA(f1, data=NL, nclass=7, maxiter=3000, nrep=5) #the chosen one
LCA_NL_8 <- poLCA(f1, data=NL, nclass=8, maxiter=3000, nrep=5)
plot(LCA_NL_6)
#add predclass to NL and merge
NL_CCA$pred = LCA_NL_6$predclass
#filter out second CCA class
NL_CCA = NL_CCA %>%
filter(mem != 2)
#filter useless v
NL_CCA1_EGA = NL_CCA %>%
filter(mem == 1) %>%
select(perc_income:ib_sex)
NL_CCA2_EGA = NL_CCA %>%
filter(mem == 3) %>%
select(perc_income:ib_sex)
ega_CCA1 <- EGA(data=NL_CCA1_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_CCA2 <- EGA(data=NL_CCA2_EGA,  model = "TMFG",
plot.EGA = TRUE)
#filter useless v
NL_LCA1_EGA = NL_CCA %>%
filter(pred == 1) %>%
select(perc_income:ib_sex)
NL_LCA2_EGA = NL_CCA %>%
filter(pred == 2) %>%
select(perc_income:ib_sex)
NL_LCA3_EGA = NL_CCA %>%
filter(pred == 3) %>%
select(perc_income:ib_sex)
NL_LCA4_EGA = NL_CCA %>%
filter(pred == 4) %>%
select(perc_income:ib_sex)
NL_LCA5_EGA = NL_CCA %>%
filter(pred == 5) %>%
select(perc_income:ib_sex)
NL_LCA6_EGA = NL_CCA %>%
filter(pred == 6) %>%
select(perc_income:ib_sex)
ega_LCA_NL_1 <- EGA(data=NL_LCA1_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_NL_2 <- EGA(data=NL_LCA2_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_NL_3 <- EGA(data=NL_LCA3_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_NL_4 <- EGA(data=NL_LCA4_EGA,  model = "TMFG",
plot.EGA = TRUE)
ega_LCA_NL_5 <- EGA(data=NL_LCA5_EGA,  model = "TMFG", # da problemi
plot.EGA = TRUE)
ega_LCA_NL_6 <- EGA(data=NL_LCA6_EGA,  model = "TMFG",
plot.EGA = TRUE)
