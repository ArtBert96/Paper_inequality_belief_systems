longnames <- c(
"Inequality belief - wealthy family",
"Inequality belief - parental education",
"Inequality belief - education",
"Inequality belief - hard work",
"Inequality belief - knowing the right people",
"Inequality belief - having political connections",
"Inequality belief - giving bribes",
"Inequality belief - race",
"Inequality belief - religion",
"Inequality belief - sex")
CCA_group <- cca(USA, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
CCA_group$membership
frq
frq(CCA_group$membership)
plot(CCA_group, 1)
plot(CCA_group, 2)
plot(CCA_group, 8)
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
p_load(tidyverse, janitor, here, haven, labelled, sjmisc, skimr, ggplot2, jtools,
stargazer, IsingFit, qgraph, Matrix, igraph, NetworkComparisonTest, bootnet,
rio, IsingSampler, compute.es, foreign, mgm, matrixcalc, openxlsx, RColorBrewer,
corclass, poLCA)
load(here("Output",  "230313 - Databases.RData"))
USA=issp_2019_ib %>%
na.omit()
shortnames <- c(
"ib_weafam", "ib_edupar", "ib_edu", "ib_work",   "ib_people", "ib_pol",
"ib_bribes", "ib_race",   "ib_relig",  "ib_sex")
longnames <- c(
"Inequality belief - wealthy family",
"Inequality belief - parental education",
"Inequality belief - education",
"Inequality belief - hard work",
"Inequality belief - knowing the right people",
"Inequality belief - having political connections",
"Inequality belief - giving bribes",
"Inequality belief - race",
"Inequality belief - religion",
"Inequality belief - sex")
CCA_group <- cca(USA, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
plot(CCA_group, 1)
plot(CCA_group, 2)
plot(CCA_group, 4)
plot(CCA_group, 9)
plot(CCA_group, 10)
View(CCA_group)
View(CCA_group)
#their cor matrix
print(round(CCA_group$modules[[1]]$cormat,1))
print(round(CCA_group$modules[[1]]$cormat,1))
print(round(CCA_group$modules[[1]]$cormat,2))
print(round(CCA_group$modules[[1]]$cormat,4))
print(round(CCA_group$modules[[1]]$cormat,9))
print(round(CCA_group$modules[[1]]$cormat,10))
#add membership to USA
USA_CCA = USA
USA_CCA
#extract membership
membership_CCA = CCA_group$membership
membership_CCA
USA_CCA = USA_CCA$membership
USA_CCA = USA_CCA$membership
USA_CCA
USA_CCA
#add membership to USA
USA_CCA = USA
USA_CCA
USA_CCA$membership = CCA_group$membership
USA_CCA
USA_CCA
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(membership == 1)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(membership == 1) %>%
na.omit
CCA_1 = USA_CCA %>%
filter(membership == 2)
CCA_1 = USA_CCA %>%
filter(membership == 1)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(membership == 1)
CCA_2 = USA_CCA %>%
filter(membership == 2)
CCA_4 = USA_CCA %>%
filter(membership == 4)
CCA_9 = USA_CCA %>%
filter(membership == 9)
CCA_10 = USA_CCA %>%
filter(membership == 10)
load(here("Output",  "230313 - Mijs_Databases.RData"))
USA=issp_2019_ib %>%
na.omit()
issp_2019_ib
load(here("Output",  "230313 - Mijs_Databases.RData"))
USA=mijs_us_ib %>%
na.omit()
shortnames <- c(
"ib_weafam", "ib_edupar", "ib_edu", "ib_work",   "ib_people", "ib_pol",
"ib_bribes", "ib_race",   "ib_relig",  "ib_sex")
longnames <- c(
"Inequality belief - wealthy family",
"Inequality belief - parental education",
"Inequality belief - education",
"Inequality belief - hard work",
"Inequality belief - knowing the right people",
"Inequality belief - having political connections",
"Inequality belief - giving bribes",
"Inequality belief - race",
"Inequality belief - religion",
"Inequality belief - sex")
USA=mijs_us_ib %>%
filter(country == 1) %>%
na.omit()
#data
load(here("Output",  "230313 - Mijs_Databases.RData"))
USA=mijs_us_ib %>%
na.omit()
View(USA)
#data
load(here("Output",  "230313 - Mijs_Databases.RData"))
USA=mijs_us_ib %>%
na.omit()
shortnames <- c(
"ib_weafam", "ib_edupar", "ib_edu", "ib_work",   "ib_people", "ib_pol",
"ib_bribes", "ib_race",   "ib_relig",  "ib_sex")
longnames <- c(
"Inequality belief - wealthy family",
"Inequality belief - parental education",
"Inequality belief - education",
"Inequality belief - hard work",
"Inequality belief - knowing the right people",
"Inequality belief - having political connections",
"Inequality belief - giving bribes",
"Inequality belief - race",
"Inequality belief - religion",
"Inequality belief - sex")
CCA_group <- cca(USA, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
#CCA applied to ISSP USA
CCA_group <- cca(USA, filter.significance = TRUE, filter.value = 0.001,
zero.action = c("ownclass"))
View(USA)
membership_CCA = CCA_group$membership
membership_CCA
plot(CCA_group, 1)
plot(CCA_group, 22)
print(round(CCA_group$modules[[1]]$cormat,1))
print(round(CCA_group$modules[[1]]$cormat,22))
CCA_group <- cca(USA, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
plot(CCA_group, 1)
plot(CCA_group, 3)
#their cor matrix
print(round(CCA_group$modules[[1]]$cormat,1))
print(round(CCA_group$modules[[1]]$cormat,3))
USA_CCA = USA
USA_CCA$membership = CCA_group$membership
CCA_1 = USA_CCA %>%
filter(membership == 1)
CCA_2 = USA_CCA %>%
filter(membership == 3)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(membership == 1) %>%
select(-membership)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(membership == 1) %>%
select(-c(membership))
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(membership == 1) %>%
select(-membership)
CCA_1
USA_CCA
head(USA_CCA)
names(USA_CCA)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(membership == 1) %>%
select(-c(membership))
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(membership == 1) %>%
select(-c(membership))
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(membership == 1) %>%
select(-membership)
remove(CCA_1$membership)
USA_CCA$mem = CCA_group$membership
CCA_1 = USA_CCA %>%
filter(mem == 1)
CCA_1 = USA_CCA %>%
filter(mem == 1) %>%
select(-mem)
#add membership to USA
USA_CCA = USA
USA_CCA
CCA_group
USA_CCA$mem = CCA_group$membership
USA_CCA
names(USA_CCA)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(mem == 1) %>%
select(-mem)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
filter(mem == 1) %>%
select(ineq_post1:ib_sex)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
as.data.frame() %>%
filter(mem == 1) %>%
select(ineq_post1:ib_sex)
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
p_load(tidyverse, janitor, here, haven, labelled, sjmisc, skimr, ggplot2, jtools,
stargazer, IsingFit, qgraph, Matrix, igraph, NetworkComparisonTest, bootnet,
rio, IsingSampler, compute.es, foreign, mgm, matrixcalc, openxlsx, RColorBrewer,
corclass, poLCA)
#Packages conflicts
conflict_prefer("select", "dplyr")
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
p_load(tidyverse, janitor, here, haven, labelled, sjmisc, skimr, ggplot2, jtools,
stargazer, IsingFit, qgraph, Matrix, igraph, NetworkComparisonTest, bootnet,
rio, IsingSampler, compute.es, foreign, mgm, matrixcalc, openxlsx, RColorBrewer,
corclass, poLCA, conflicted)
#Packages conflicts
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
options(max.print=999999)
options(scipen=999)
#data
load(here("Output",  "230313 - Mijs_Databases.RData"))
USA=mijs_us_ib %>%
na.omit()
shortnames <- c(
"ib_weafam", "ib_edupar", "ib_edu", "ib_work",   "ib_people", "ib_pol",
"ib_bribes", "ib_race",   "ib_relig",  "ib_sex")
longnames <- c(
"Inequality belief - wealthy family",
"Inequality belief - parental education",
"Inequality belief - education",
"Inequality belief - hard work",
"Inequality belief - knowing the right people",
"Inequality belief - having political connections",
"Inequality belief - giving bribes",
"Inequality belief - race",
"Inequality belief - religion",
"Inequality belief - sex")
#CCA applied to ISSP USA
CCA_group <- cca(USA, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
#extract membership
membership_CCA = CCA_group$membership
#preliminary plots
plot(CCA_group, 1)
plot(CCA_group, 3)
#their cor matrix
print(round(CCA_group$modules[[1]]$cormat,1))
print(round(CCA_group$modules[[1]]$cormat,3))
#add membership to USA
USA_CCA = USA
USA_CCA$mem = CCA_group$membership
names(USA_CCA)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
as.data.frame() %>%
filter(mem == 1) %>%
select(ineq_post1:ib_sex)
CCA_2 = USA_CCA %>%
as.data.frame() %>%
filter(mem == 3) %>%
select(ineq_post1:ib_sex)
f1 <- as.formula(cbind(ineq_post1, ineq_post2, ineq_post3, ineq_post4, ineq_pre1,
ineq_pre2,ineq_pre3,ib_weafam,ib_edupar,ib_edu,ib_work,ib_people,
ib_race,ib_migra,ib_relig,ib_sex)~1)
#lcas
LCA2 <- poLCA(f1, data=USA, nclass=2)
LCA3 <- poLCA(f1, data=USA, nclass=3)
LCA4 <- poLCA(f1, data=USA, nclass=4)
LCA5 <- poLCA(f1, data=USA, nclass=5)
LCA6 <- poLCA(f1, data=USA, nclass=6)
LCA7 <- poLCA(f1, data=USA, nclass=7)
plot(LCA2)
plot(LCA6)
#freq total
frq(USA)
?poLCA
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
p_load(tidyverse, janitor, here, haven, labelled, sjmisc, skimr, ggplot2, jtools,
stargazer, IsingFit, qgraph, Matrix, igraph, NetworkComparisonTest, bootnet,
rio, IsingSampler, compute.es, foreign, mgm, matrixcalc, openxlsx, RColorBrewer,
corclass, poLCA, conflicted)
#Packages conflicts
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
options(max.print=999999)
options(scipen=999)
#data
load(here("Output",  "230313 - Mijs_Databases.RData"))
USA=mijs_us_ib %>%
na.omit()
#freq total
frq(USA)
shortnames <- c(
"ib_weafam", "ib_edupar", "ib_edu", "ib_work",   "ib_people", "ib_pol",
"ib_bribes", "ib_race",   "ib_relig",  "ib_sex")
longnames <- c(
"Inequality belief - wealthy family",
"Inequality belief - parental education",
"Inequality belief - education",
"Inequality belief - hard work",
"Inequality belief - knowing the right people",
"Inequality belief - having political connections",
"Inequality belief - giving bribes",
"Inequality belief - race",
"Inequality belief - religion",
"Inequality belief - sex")
#CCA applied to ISSP USA
CCA_group <- cca(USA, filter.significance = TRUE, filter.value = 0.01,
zero.action = c("ownclass"))
#extract membership
membership_CCA = CCA_group$membership
#preliminary plots
plot(CCA_group, 1)
plot(CCA_group, 3)
#their cor matrix
print(round(CCA_group$modules[[1]]$cormat,1))
print(round(CCA_group$modules[[1]]$cormat,3))
#add membership to USA
USA_CCA = USA
USA_CCA$mem = CCA_group$membership
names(USA_CCA)
#prepare CCA-driven dataframe for EGA
CCA_1 = USA_CCA %>%
as.data.frame() %>%
filter(mem == 1) %>%
select(ineq_post1:ib_sex)
CCA_2 = USA_CCA %>%
as.data.frame() %>%
filter(mem == 3) %>%
select(ineq_post1:ib_sex)
f1 <- as.formula(cbind(ineq_post1, ineq_post2, ineq_post3, ineq_post4, ineq_pre1,
ineq_pre2,ineq_pre3,ib_weafam,ib_edupar,ib_edu,ib_work,ib_people,
ib_race,ib_migra,ib_relig,ib_sex)~1)
#lcas
LCA2 <- poLCA(f1, data=USA, nclass=2, maxiter=3000, nrep=5)
LCA3 <- poLCA(f1, data=USA, nclass=3, maxiter=3000, nrep=5)
LCA4 <- poLCA(f1, data=USA, nclass=4, maxiter=3000, nrep=5)
LCA5 <- poLCA(f1, data=USA, nclass=5, maxiter=3000, nrep=5)
LCA6 <- poLCA(f1, data=USA, nclass=6, maxiter=3000, nrep=5)
LCA7 <- poLCA(f1, data=USA, nclass=7, maxiter=3000, nrep=5)
#plot
plot(LCA2)
plot(LCA6)
#comment for LCA6
#1: low perception mid-high individualist and mid high structuralist
#2: low perception high individualist low structuralist
#3: high perception high individualist low structuralist
#4: high perception mid-high individualist and mid high structuralist
#5: super high perception of ineq, super high individualist
#6: high everything
##slide13:
#plot(LCA2)
##slide14:
#LCA3 <- poLCA(f1, data=USA, nclass=3)
#
##slide15:
#LCA3 <- poLCA(f1, data=USA, nclass=3, maxiter=3000)
#LCA3 <- poLCA(f1, data=USA, nclass=3, nrep=5)
#LCA3 <- poLCA(f1, data=USA, nclass=3, maxiter=3000, nrep=5)
#
#LCA4 <- poLCA(f1, data=USA, nclass=4, maxiter=3000, nrep=5)
#LCA4 <- poLCA(f1, data=USA, nclass=4, maxiter=5000, nrep=5)
#
#LCA5 <- poLCA(f1, data=USA, nclass=5, maxiter=5000, nrep=10)
#
#LCA2
#LCA3
#LCA4
#LCA5
#
##predicted class membership is in:
#LCA3$predclass[1:30]
#
##could be used as another variable (part of the data):
#USA$LCAf5 <- LCA3$predclass
LCA8 <- poLCA(f1, data=USA, nclass=8, maxiter=3000, nrep=5)
plot(LCA7)
plot(LCA7)
plot(LCA7)
plot(LCA7)
plot(LCA7)
plot(LCA6)
plot(LCA7)
dev.off()
plot(LCA7)
#adjust plot margins
par(mar = c(1, 1, 1, 1))
plot(LCA7)
bo = plot(LCA7)
bo = plot(LCA7)
?plot
pdf(file = '../Output/7.pdf',paper = "USr",
height = 9, width = 12)
bo = plot(LCA7)
dev.off
pdf(file = '../Output/7.pdf',paper = "USr",
height = 9, width = 12)
bo = plot(LCA7)
dev.off()
plot(LCA6)
LCA2_a <- poLCA(f1, data=USA, nclass=2)
LCA3_a <- poLCA(f1, data=USA, nclass=3)
LCA4_a <- poLCA(f1, data=USA, nclass=4)
LCA5_a <- poLCA(f1, data=USA, nclass=5)
LCA6_a <- poLCA(f1, data=USA, nclass=6)
LCA7_a <- poLCA(f1, data=USA, nclass=7)
LCA8_a <- poLCA(f1, data=USA, nclass=8)
plot(LCA6)
plot(LCA6_a)
##predicted class membership is in:
LCA6$predclass
#add predclass to USA
USA_CCA$pred = LCA6$predclass
names(USA_CCA)
frq(USA_CCA, mem, pred)
USA_CCA = USA_CCA %>%
filter(mem != 2)
names(USA_CCA)
frq(USA_CCA, mem, pred)
#filter useless v
USA_CCA1_EGA = USA_CCA %>%
filter(mem == 1) %>%
select(ineq_post1:ib_sex)
USA_CCA2_EGA = USA_CCA %>%
filter(mem == 3) %>%
select(ineq_post1:ib_sex)
ega_CCA1 <- EGA(data=USA_CCA1_EGA,  model = "glasso",
plot.EGA = TRUE)
library(pacman)
p_load(tidyverse, janitor, here, haven, labelled, sjmisc, skimr, ggplot2, jtools,
stargazer, IsingFit, qgraph, Matrix, igraph, NetworkComparisonTest, bootnet,
rio, IsingSampler, compute.es, foreign, mgm, matrixcalc, openxlsx, RColorBrewer,
corclass, poLCA, conflicted, EGAnet)
#filter useless v
USA_CCA1_EGA = USA_CCA %>%
filter(mem == 1) %>%
select(ineq_post1:ib_sex)
USA_CCA2_EGA = USA_CCA %>%
filter(mem == 3) %>%
select(ineq_post1:ib_sex)
ega_CCA1 <- EGA(data=USA_CCA1_EGA,  model = "glasso",
plot.EGA = TRUE)
ega_CCA3 <- EGA(data=USA_CCA3_EGA,  model = "glasso",
plot.EGA = TRUE)
#filter useless v
USA_CCA1_EGA = USA_CCA %>%
filter(mem == 1) %>%
select(ineq_post1:ib_sex)
USA_CCA2_EGA = USA_CCA %>%
filter(mem == 3) %>%
select(ineq_post1:ib_sex)
ega_CCA1 <- EGA(data=USA_CCA1_EGA,  model = "glasso",
plot.EGA = TRUE)
ega_CCA2 <- EGA(data=USA_CCA2_EGA,  model = "glasso",
plot.EGA = TRUE)
#filter useless v
USA_LCA1_EGA = USA_CCA %>%
filter(pred == 1) %>%
select(ineq_post1:ib_sex)
USA_LCA2_EGA = USA_CCA %>%
filter(pred == 2) %>%
select(ineq_post1:ib_sex)
USA_LCA3_EGA = USA_CCA %>%
filter(pred == 3) %>%
select(ineq_post1:ib_sex)
USA_LCA4_EGA = USA_CCA %>%
filter(pred == 4) %>%
select(ineq_post1:ib_sex)
USA_LCA5_EGA = USA_CCA %>%
filter(pred == 5) %>%
select(ineq_post1:ib_sex)
USA_LCA6_EGA = USA_CCA %>%
filter(pred == 6) %>%
select(ineq_post1:ib_sex)
ega_LCA1 <- EGA(data=USA_LCA1_EGA,  model = "glasso",
plot.EGA = TRUE)
ega_LCA2 <- EGA(data=USA_LCA2_EGA,  model = "glasso",
plot.EGA = TRUE)
ega_LCA3 <- EGA(data=USA_LCA3_EGA,  model = "glasso",
plot.EGA = TRUE)
ega_LCA4 <- EGA(data=USA_LCA4_EGA,  model = "glasso",
plot.EGA = TRUE)
ega_LCA5 <- EGA(data=USA_LCA5_EGA,  model = "glasso",
plot.EGA = TRUE)
ega_LCA6 <- EGA(data=USA_LCA6_EGA,  model = "glasso",
plot.EGA = TRUE)
